!function(e,t,s){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=o(t),a=o(s),n=Object.assign({routerChange:function(){},tipMessage:function(e){alert(e)},timeout:3e5,hasToken:!1,tokenError:1010,baseURL:""},r.default.defaults),c=r.default.create(n);function i(e,t){const s=sessionStorage.getItem("token");n.hasToken&&!s&&g();const o=n.hasToken?{token:s}:{};let r=a.default.stringify(Object.assign({},o,t));const i=n.baseURL+e;return new Promise(((e,t)=>{c.get(i+"?"+r).then((t=>{const s=t.data;s.code==n.tokenError?(l(s.desc),sessionStorage.clear(),localStorage.clear(),g()):e(s)})).catch((e=>{t(e.data)}))}))}function u(e,t){const s=sessionStorage.getItem("token");n.hasToken&&!s&&g();const o=n.hasToken?{token:s}:{};let r=a.default.stringify(Object.assign({},o,t));const i=n.baseURL+e;return new Promise(((e,t)=>{c.post(i,r).then((t=>{const s=t.data;s.code==n.tokenError?(l(s.desc),sessionStorage.clear(),localStorage.clear(),g()):e(s)})).catch((e=>{t(e.data)}))}))}c.interceptors.request.use((e=>{if(n.hasToken){const t=sessionStorage.getItem("token");t&&(e.headers.Authorization=t)}return e}),(e=>Promise.error(e))),c.interceptors.response.use((e=>200===e.status?Promise.resolve(e):Promise.reject(e)),(e=>{const{response:t}=e;return t?(f(t.status,t.data.message),Promise.reject(t)):Promise.reject(e)}));const l=e=>{n.tipMessage(e)},g=()=>{n.routerChange()},f=(e,t)=>{switch(e){case 401:g();break;case n.tokenError:l("登录信息已过期，请重新登录！"),sessionStorage.removeItem("token"),setTimeout((()=>{g()}),1e3);break;case 404:l("请求的资源不存在");break;case 500:l("服务器出错");break;default:console.log(t)}};let d={install:function(e){e.prototype.$post=u,e.prototype.$get=i}};d.defaultConfig=n,e.default=d,Object.defineProperty(e,"__esModule",{value:!0})}(this["vue2-axios"]=this["vue2-axios"]||{},axios,qs);
